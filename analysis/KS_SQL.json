{"paragraphs":[{"text":"%pyspark\nregion=z.select(\"region\", [(\"종로구\",\"종로구\"),\n                    (\"중구\",\"중구\"),\n                     (\"용산구\",\"용산구\"),\n                      (\"성동구\",\"성동구\"),\n                       (\"광진구\",\"광진구\"),\n                        (\"동대문구\",\"동대문구\"),\n                         (\"중랑구\",\"중랑구\"),\n                          (\"성북구\",\"성북구\"),\n                           (\"강북구\",\"강북구\"),\n                            (\"도봉구\",\"도봉구\"),\n                             (\"노원구\",\"노원구\"),\n                             (\"은평구\",\"은평구\"),\n                             (\"서대문구\",\"서대문구\"),\n                             (\"마포구\",\"마포구\"),\n                             (\"양천구\",\"양천구\"),\n                             (\"강서구\",\"강서구\"),\n                             (\"구로구\",\"구로구\"),\n                             (\"영등포구\",\"영등포구\"),\n                             (\"금천구\",\"금천구\"),\n                             (\"동작구\",\"동작구\"),\n                             (\"관악구\",\"관악구\"),\n                              (\"서초구\",\"서초구\"),\n                               (\"강남구\",\"강남구\"),\n                                (\"송파구\",\"송파구\"),\n                                 (\"강동구\",\"강동구\"),])\nz.put(\"ks_input_region\",region)\n\nstore_type=z.select(\"store_type\", [(\"pizza\",\"pizza\"),\n                    (\"chicken\",\"chicken\"),\n                    (\"china\",\"chinese_food\"),\n                    ])\nz.put(\"ks_input_store_type\",store_type)\n\nstart_date=z.textbox(\"start date: ex)20180101\")\nz.put(\"ks_input_start_date\", start_date)\nend_date=z.textbox(\"end date: ex)20181231\")\nz.put(\"ks_input_end_date\", end_date)\n\nby=z.select(\"By\", [(\"Day\",\"Day\"),\n                    (\"Gender\",\"Gender\"),\n                    (\"Age\",\"Age\"),\n                    ])\nz.put(\"ks_By\",by)\nz.z.run(\"\")#TO_KS_2","user":"anonymous","dateUpdated":"2019-06-16T02:54:12+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560621233736_-268814695","id":"20190616-025353_1036119032","dateCreated":"2019-06-16T02:53:53+0900","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11569"},{"text":"%pyspark\n\n#ks 문자화\nstart_time=time.time()\nprint(start_time)\nselect_region=z.get(\"ks_input_region\")\nselect_region=str(select_region.encode('utf-8'))\nselect_region_DF=str(select_region)\nselect_store_type=z.get(\"ks_input_store_type\")\nselect_store_type=str(select_store_type)\nselect_start_date=z.get(\"ks_input_start_date\")\nselect_start_date=str(select_start_date)\nselect_end_date=z.get(\"ks_input_end_date\")\nselect_end_date=str(select_end_date)\nselect_by=z.get(\"ks_By\")\nselect_by=str(select_by)\nend_time=time.time()-start_time\nprint(end_time)\n#ks 문자화 끝\n\n#ks result 구성\nstart_time=time.time()\nprint(start_time)\n\ndf_pizza_concat.registerTempTable(\"ks_df_pizza_concat\")\ndf_chicken_concat.registerTempTable(\"ks_df_chicken_concat\")\ndf_china_concat.registerTempTable(\"ks_df_china_concat\")\n\nquery=\"select \"+select_by+\" , sum(Order) from \"+\"ks_df_\"+select_store_type.lower()+\"_concat\"+\" where Gu='\"+select_region+\"' and Dates>=\"+select_start_date+\" and Dates<=\"+select_end_date+\" group by \"+select_by+\" order by \"+select_by+\" ASC\"\n\n\nks_result=sqlContext.sql(query)\nks_result.registerTempTable(\"ks_result\")\n\nend_time=time.time()-start_time\nprint(end_time)\n#ks result 구성 끝\n\nz.z.run(\"\")#TO_KS_3","user":"anonymous","dateUpdated":"2019-06-16T02:55:03+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560621289039_1096724696","id":"20190616-025449_756017779","dateCreated":"2019-06-16T02:54:49+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:11570"},{"text":"%sql\nselect * from ks_result","user":"anonymous","dateUpdated":"2019-06-16T02:55:28+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560621322701_-1306026189","id":"20190616-025522_359699219","dateCreated":"2019-06-16T02:55:22+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:11571"},{"text":"%pysark\n","user":"anonymous","dateUpdated":"2019-06-16T02:55:44+0900","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1560621328284_-1980155547","id":"20190616-025528_793054885","dateCreated":"2019-06-16T02:55:28+0900","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:11572"}],"name":"KS_SQL","id":"2EG3QJM5C","noteParams":{},"noteForms":{},"angularObjects":{"angular:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}